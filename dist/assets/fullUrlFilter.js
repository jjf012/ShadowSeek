async function i(t){if(crypto?.subtle){const e=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",e);return[...new Uint8Array(s)].map(o=>o.toString(16).padStart(2,"0")).join("")}let r=0;for(let e=0;e<t.length;e+=1){const s=t.charCodeAt(e);r=(r<<5)-r+s,r|=0}return`fallback-${r>>>0}`}async function p(t){return`scan:url:${await i(t)}`}function c(t){return(t??"").trim().replace(/^['"]+|['"]+$/g,"")}function u(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function f(t){const e=`^${t.split("*").map(u).join(".*")}$`;return new RegExp(e,"i")}function h(t,r){const e=r??[];if(!e.length)return!1;const s=c(t).toLowerCase();if(!s)return!1;for(const o of e){const n=(o??"").trim();if(!n)continue;const a=n.toLowerCase();if(a.includes("*")){if(f(a).test(s))return!0;continue}if(s.includes(a))return!0}return!1}function l(t){const r=t??[],e=[],s=new Set;for(const o of r){let n=(o??"").trim().toLowerCase();n&&(n.startsWith(".")||(n=`.${n}`),n!=="."&&(s.has(n)||(s.add(n),e.push(n))))}return e}function g(t,r){const e=(t??"").trim();if(!/^https?:\/\//i.test(e))return!1;const s=l(r);if(!s.length)return!1;try{const n=(new URL(e).pathname??"").toLowerCase();if(!n)return!1;for(const a of s)if(n.endsWith(a))return!0}catch{return!1}return!1}export{h as a,c as b,i as h,g as i,l as n,p as s};
