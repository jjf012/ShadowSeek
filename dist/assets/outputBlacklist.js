async function c(t){if(crypto?.subtle){const e=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",e);return[...new Uint8Array(r)].map(s=>s.toString(16).padStart(2,"0")).join("")}let n=0;for(let e=0;e<t.length;e+=1){const r=t.charCodeAt(e);n=(n<<5)-n+r,n|=0}return`fallback-${n>>>0}`}async function f(t){return`scan:url:${await c(t)}`}function i(t){return(t??"").trim().replace(/^['"]+|['"]+$/g,"")}function u(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function l(t){const e=`^${t.split("*").map(u).join(".*")}$`;return new RegExp(e,"i")}function p(t,n){const e=n??[];if(!e.length)return!1;const r=i(t).toLowerCase();if(!r)return!1;for(const s of e){const o=(s??"").trim();if(!o)continue;const a=o.toLowerCase();if(a.includes("*")){if(l(a).test(r))return!0;continue}if(r.includes(a))return!0}return!1}export{c as h,p as i,i as n,f as s};
