const c={includeInline:!0,maxContentSizeKB:5e3,requestTimeoutMs:2e4,scanTimeoutMs:3e3,disableTimeouts:!0,autoScan:!1,outputBlacklist:["http://www.w3.org/*","https://www.w3.org/*","text/*","/dist/","/node_modules/","static/*","video/*","image/*","./*.svg","./*.png","./*.jpg","./*.jpeg","./*.gif","./*.webp","./*.ico","./*.css","./*.map","./*.woff","./*.woff2","./*.ttf","./*.eot","./*.mp4","./*.webm","./*.mp3","./*.wav","./*.js","./*.mjs"],domainBlacklist:["google-analytics.com","googletagmanager.com","gstatic.com","doubleclick.net","bdstatic.com","cdnjs.cloudflare.com","jsdelivr.net","unpkg.com","bootstrapcdn.com"],fileBlacklist:[".map","/vendor","/node_modules","react.production.min.js","vue.runtime.esm","lodash","moment","chunk-vendors","element-ui","elementUI","sockjs"]},n="shadowseek-settings";function d(){return new Promise(e=>{chrome.storage.local.get([n],t=>{e(t[n]??{})})})}async function l(){const e=await d();return{...c,...e}}async function u(e){const t={...await l(),...e};return await chrome.storage.local.set({[n]:t}),t}const r="shadowseek-rules",s=[{id:"github-token",name:"GitHub Token",description:"GitHub 访问令牌泄露",category:"credential",severity:"high",pattern:"(?:ghp|gho|ghu|ghs|ghr)_[A-Za-z0-9]{36,}",flags:"g",enabled:!0},{id:"google-api-key",name:"Google API Key",description:"Google API Key 泄露",category:"api_key",severity:"high",pattern:"AIza[0-9A-Za-z\\-_]{35}",flags:"g",enabled:!0},{id:"aws-access-key",name:"AWS Access Key",description:"AWS Access Key ID",category:"cloud",severity:"critical",pattern:"(?:AKIA|A3T|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}",flags:"g",enabled:!0},{id:"aws-secret-key",name:"AWS Secret",description:"AWS Secret Access Key",category:"cloud",severity:"critical",pattern:`(?:aws_secret_access_key|aws_secret_key)\\s*[:=]\\s*['"]?([A-Za-z0-9/+=]{16,})`,flags:"gi",enabled:!0},{id:"aliyun-access-key",name:"阿里云 AccessKey",description:"阿里云 AK",category:"cloud",severity:"critical",pattern:"(?:LTAI|LTAIAccessKeyId)[A-Za-z0-9]{12,20}",flags:"g",enabled:!0},{id:"aliyun-secret",name:"阿里云 Secret",description:"阿里云 AccessKey Secret",category:"cloud",severity:"critical",pattern:`(?:accessKeySecret|access_key_secret)\\s*[:=]\\s*['"]?([A-Za-z0-9+/=]{30,})`,flags:"gi",enabled:!0},{id:"tencent-secret-id",name:"腾讯云 SecretId",description:"腾讯云 SecretId",category:"cloud",severity:"critical",pattern:"(?:AKID|AKIDAccessKeyId)[A-Za-z0-9]{13,40}",flags:"g",enabled:!0},{id:"tencent-secret-key",name:"腾讯云 SecretKey",description:"腾讯云 SecretKey",category:"cloud",severity:"critical",pattern:`(?:SecretKey|secret_key)\\s*[:=]\\s*['"]?([A-Za-z0-9]{32,40})`,flags:"gi",enabled:!0},{id:"jwt",name:"JWT",description:"疑似 JWT Token",category:"credential",severity:"high",pattern:"eyJ[A-Za-z0-9_-]{10,}\\.[A-Za-z0-9._-]+\\.[A-Za-z0-9._-]+",flags:"g",enabled:!0},{id:"password-assign",name:"硬编码密码",description:"硬编码密码/密钥",category:"credential",severity:"high",pattern:`(?:password|passwd|pwd|secret|passphrase)\\s*[:=]\\s*['"][^'"\\n]{4,}`,flags:"gi",enabled:!0},{id:"endpoint-internal",name:"内部接口域名",description:"疑似内网/接口域名",category:"endpoint",severity:"medium",pattern:"https?:\\/\\/[\\w.-]*?(?:internal|api|svc|backend)[\\w.-]*(?::\\d+)?(?:\\/[\\w./?%&=+-]*)?",flags:"gi",enabled:!0},{id:"email",name:"邮箱",description:"邮箱地址",category:"pii",severity:"low",pattern:"[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}",flags:"gi",enabled:!0},{id:"phone-cn",name:"手机号",description:"中国大陆手机号",category:"pii",severity:"medium",pattern:`(?<!\\d)['"]?(1[3-9]\\d{9})['"]?(?!\\d)`,flags:"g",enabled:!0},{id:"idcard-cn",name:"身份证号",description:"中国大陆身份证号",category:"pii",severity:"high",pattern:`(?<!\\d)['"]?([1-9]\\d{5}(?:18|19|20)\\d{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[12]\\d|3[01])\\d{3}(?:\\d|X|x))['"]?(?!\\d)`,flags:"g",enabled:!0},{id:"db-url",name:"数据库连接串",description:"数据库连接 URL",category:"db",severity:"critical",pattern:`(?:mongodb|postgres|mysql|redis)://[^\\s'"<>]{10,}`,flags:"gi",enabled:!0},{id:"jdbc-url",name:"JDBC 连接",description:"JDBC 连接字符串",category:"db",severity:"critical",pattern:`jdbc:(?:mysql|postgresql|oracle|sqlserver|mariadb)://[^\\s'"]+`,flags:"gi",enabled:!0},{id:"access-token-urlparam",name:"URL 中的凭证",description:"URL 参数中的 token/key/secret",category:"credential",severity:"medium",pattern:`[?&](?:token|key|secret|password|passwd|apikey|api_key|access_token|auth)=([^&\\s'"]+)`,flags:"gi",enabled:!0},{id:"sourcemap",name:"SourceMap",description:"源码映射文件引用",category:"info",severity:"low",pattern:"\\/\\/[#@]\\s*sourceMappingURL\\s*=\\s*([^\\s]+\\.map)",flags:"g",enabled:!0},{id:"swagger-doc",name:"API 文档",description:"swagger/openapi/redoc 路径",category:"endpoint",severity:"low",pattern:`\\/(?:swagger|api-docs|openapi|redoc)\\/[^\\s'"]*`,flags:"i",enabled:!0},{id:"api-endpoint",name:"API 端点",description:"接口端点 URL",category:"endpoint",severity:"low",pattern:`https?://[^\\s'"]+/api/[^\\s'"]+`,flags:"gi",enabled:!0},{id:"api-endpoint-rel",name:"API 相对路径",description:"以 /api 开头的接口路径",category:"endpoint",severity:"low",pattern:`['"](/api/[^'"\\s]+)['"]`,flags:"gi",enabled:!0},{id:"api-versioned",name:"版本化接口",description:"/v1 /v2 /v3 版本接口",category:"endpoint",severity:"low",pattern:`['"](/v\\d+[^'"\\s]+)['"]`,flags:"gi",enabled:!0},{id:"api-rest",name:"REST 接口",description:"rest 路径接口",category:"endpoint",severity:"low",pattern:`['"](/rest/[^'"\\s]+)['"]`,flags:"gi",enabled:!0},{id:"graphql-endpoint",name:"GraphQL 端点",description:"GraphQL API",category:"endpoint",severity:"low",pattern:`['"](/graphql[^'"\\s]*)['"]`,flags:"gi",enabled:!0},{id:"rpc-endpoint",name:"RPC 端点",description:"RPC 接口",category:"endpoint",severity:"low",pattern:`['"](/rpc/[^'"\\s]+)['"]`,flags:"gi",enabled:!0},{id:"ws-endpoint",name:"WebSocket 端点",description:"ws/wss 地址",category:"endpoint",severity:"low",pattern:`wss?:\\/\\/[^\\s'"]+`,flags:"gi",enabled:!0},{id:"endpoint-config-key",name:"端点配置键",description:"baseUrl/apiUrl/endpoint 配置",category:"endpoint",severity:"low",pattern:`\\b(baseUrl|baseURL|apiUrl|api_url|endpoint)\\b\\s*[:=]\\s*['"]((?:https?:\\/\\/|\\/)[^'"\\s]+)['"]`,flags:"gi",enabled:!0},{id:"endpoint-fetch-call",name:"fetch/axios 调用",description:"fetch/axios/XMLHttpRequest 调用的 URL",category:"endpoint",severity:"low",pattern:`(?:fetch|axios|XMLHttpRequest)\\s*\\(\\s*['"]([^'"]+)['"]`,flags:"gi",enabled:!0},{id:"graphql-endpoint",name:"GraphQL 端点",description:"GraphQL API",category:"endpoint",severity:"low",pattern:`https?://[^\\s'"]+/graphql[^\\s'"]*`,flags:"gi",enabled:!0},{id:"websocket-endpoint",name:"WebSocket 端点",description:"ws/wss 端点",category:"endpoint",severity:"low",pattern:`wss?:\\/\\/[^\\s'"]+`,flags:"gi",enabled:!0},{id:"internal-ip",name:"内网 IP",description:"私有网段 IP",category:"info",severity:"medium",pattern:"(?:10\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}|172\\.(?:1[6-9]|2\\d|3[01])\\.\\d{1,3}\\.\\d{1,3}|192\\.168\\.\\d{1,3}\\.\\d{1,3})",flags:"g",enabled:!0},{id:"find-ip",name:"IP（find）",description:"提取 IPv4（来自 find 的规则，偏“多捞线索”）",category:"info",severity:"low",pattern:String.raw`['"](([a-zA-Z0-9]+:)?\/\/)?\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}(\/.*?)?['"]`,flags:"g",enabled:!0},{id:"find-ip-port",name:"IP:PORT（find）",description:"提取 IPv4:PORT（来自 find 的规则，偏“多捞线索”）",category:"info",severity:"low",pattern:String.raw`['"](([a-zA-Z0-9]+:)?\/\/)?\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\:\d{1,5}(\/.*?)?['"]`,flags:"g",enabled:!0},{id:"find-domain",name:"域名（find）",description:"提取域名（来自 find 的规则，包含较长 TLD 列表）",category:"endpoint",severity:"low",pattern:String.raw`['"](([a-zA-Z0-9]+:)?\/\/)?[a-zA-Z0-9\-\.]*?\.(xin|com|cn|net|com.cn|vip|top|cc|shop|club|wang|xyz|luxe|site|news|pub|fun|online|win|red|loan|ren|mom|net.cn|org|link|biz|bid|help|tech|date|mobi|so|me|tv|co|vc|pw|video|party|pics|website|store|ltd|ink|trade|live|wiki|space|gift|lol|work|band|info|click|photo|market|tel|social|press|game|kim|org.cn|games|pro|men|love|studio|rocks|asia|group|science|design|software|engineer|lawyer|fit|beer|tw|我爱你|中国|公司|网络|在线|网址|网店|集团|中文网)(\:\d{1,5})?(\/)?['"]`,flags:"g",enabled:!0},{id:"find-url",name:"URL（find）",description:"提取 URL（来自 find 的规则，偏“多捞线索”）",category:"endpoint",severity:"low",pattern:String.raw`['"](([a-zA-Z0-9]+:)?\/\/)?[a-zA-Z0-9\-\.]*?\.(xin|com|cn|net|com.cn|vip|top|cc|shop|club|wang|xyz|luxe|site|news|pub|fun|online|win|red|loan|ren|mom|net.cn|org|link|biz|bid|help|tech|date|mobi|so|me|tv|co|vc|pw|video|party|pics|website|store|ltd|ink|trade|live|wiki|space|gift|lol|work|band|info|click|photo|market|tel|social|press|game|kim|org.cn|games|pro|men|love|studio|rocks|asia|group|science|design|software|engineer|lawyer|fit|beer|tw|我爱你|中国|公司|网络|在线|网址|网店|集团|中文网)(\:\d{1,5})?(\/.*?)?['"]`,flags:"g",enabled:!0},{id:"find-path",name:"Path（find）",description:"提取相对路径（来自 find 的规则）",category:"endpoint",severity:"low",pattern:String.raw`['"](?:\/|\.\.\/|\.\/)[^\/\>\< \)\(\{\}\,\'\"\\]([^\>\< \)\(\{\}\,\'\"\\])*?['"]`,flags:"g",enabled:!0},{id:"find-incomplete-path",name:"IncompletePath（find）",description:"提取形如 foo/bar 的路径片段（来自 find 的规则，噪声可能较大）",category:"endpoint",severity:"low",pattern:String.raw`['"][^\/\>\< \)\(\{\}\,\'\"\\][\w\/]*?\/[\w\/]*?['"]`,flags:"g",enabled:!0},{id:"slack-token",name:"Slack Token",description:"Slack API Token",category:"credential",severity:"high",pattern:"xox[baprs]-[0-9]{10,13}-[0-9]{10,13}-[A-Za-z0-9]{24,}",flags:"g",enabled:!0},{id:"stripe-key",name:"Stripe Key",description:"Stripe 支付密钥",category:"credential",severity:"critical",pattern:"(?:sk|pk)_(?:live|test)_[0-9a-zA-Z]{24,}",flags:"g",enabled:!0},{id:"telegram-bot",name:"Telegram Bot Token",description:"Telegram Bot Token",category:"credential",severity:"medium",pattern:"[0-9]{8,10}:[A-Za-z0-9_-]{35}",flags:"g",enabled:!0},{id:"discord-bot",name:"Discord Bot Token",description:"Discord Bot Token",category:"credential",severity:"medium",pattern:"[MN][A-Za-z\\d]{23}\\.[\\w-]{6}\\.[\\w-]{27}",flags:"g",enabled:!0},{id:"twilio",name:"Twilio AuthToken",description:"Twilio Auth Token",category:"credential",severity:"high",pattern:"SK[0-9a-fA-F]{32}",flags:"g",enabled:!0},{id:"sendgrid",name:"SendGrid API Key",description:"SendGrid API Key",category:"credential",severity:"high",pattern:"SG\\.[A-Za-z0-9_-]{22}\\.[A-Za-z0-9_-]{43}",flags:"g",enabled:!0},{id:"mailgun",name:"Mailgun API Key",description:"Mailgun API Key",category:"credential",severity:"high",pattern:"key-[0-9a-zA-Z]{32}",flags:"g",enabled:!0},{id:"npm-token",name:"NPM Token",description:"NPM 访问令牌",category:"credential",severity:"high",pattern:"npm_[A-Za-z0-9]{36}",flags:"g",enabled:!0},{id:"pypi-token",name:"PyPI Token",description:"PyPI 访问令牌",category:"credential",severity:"high",pattern:"pypi-AgEIcHlwaS5vcmc[A-Za-z0-9\\-_]{50,}",flags:"g",enabled:!0},{id:"digitalocean-token",name:"DigitalOcean Token",description:"DigitalOcean 访问令牌",category:"credential",severity:"high",pattern:"dop_v1_[a-f0-9]{64}",flags:"g",enabled:!0},{id:"webhook-dingtalk-wecom",name:"企业通信 Webhook",description:"钉钉/企业微信 Webhook",category:"endpoint",severity:"medium",pattern:"https?://(?:oapi\\.dingtalk\\.com|qyapi\\.weixin\\.qq\\.com)/robot/send\\?access_token=[A-Za-z0-9]+",flags:"g",enabled:!0},{id:"url-credentials",name:"URL 内嵌凭证",description:"URL 中包含用户名密码",category:"credential",severity:"critical",pattern:`(?:https?|ftp)://([^:@\\s]+):([^@\\s]+)@[^\\s'"<>]+`,flags:"g",enabled:!0},{id:"cloud-bucket-url",name:"云存储 URL",description:"S3/OSS/COS 存储桶 URL",category:"info",severity:"medium",pattern:`(?:https?://)?(?:[a-z0-9-]+\\.)?(?:s3|oss|cos)[a-z0-9.-]*\\.(?:amazonaws\\.com|aliyuncs\\.com|myqcloud\\.com|tencentcos\\.cn)/[^\\s'"<>]+`,flags:"gi",enabled:!0}];function g(e){return e.map(t=>({...t}))}async function p(){return new Promise(e=>{chrome.storage.local.get([r],t=>{const i=t[r];Array.isArray(i)?e(i):e([])})})}async function f(e){await chrome.storage.local.set({[r]:e})}async function y(){const e=await p(),t=new Map;for(const i of s)t.set(i.id,{...i});for(const i of e)t.set(i.id,{...i});return Array.from(t.values())}function m(e){const t=[];for(const i of e)if(i.enabled)try{const a=i.flags??"gi",o=new RegExp(i.pattern,a);t.push({...i,regexp:o})}catch(a){console.warn("规则编译失败，已跳过",i.id,a)}return t}async function w(){const e=await y();return m(e)}function b(){return g(s)}export{c as D,y as a,f as b,w as c,b as g,l,u as s};
